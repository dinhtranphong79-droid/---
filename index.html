<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>New Year Fireworks 2026</title>

<style>
html,body{
  margin:0;
  background:#000;
  height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* Khung 9:16 */
#stage{
  position:relative;
  aspect-ratio:9/16;
  height:100vh;
  max-height:100vh;
  max-width:calc(100vh * 9 / 16);
  overflow:hidden;
  animation: bgAnimation 6s infinite alternate; /* thêm animation */
}

/* Gradient animation cho bầu trời */
@keyframes bgAnimation {
  0% { background: linear-gradient(to top, #000000, #001f3f, #220066); }
  50% { background: linear-gradient(to top, #000000, #003366, #330088); }
  100% { background: linear-gradient(to top, #000000, #001f3f, #220066); }
}


/* Canvas pháo hoa */
canvas{
  width:100%;
  height:100%;
  display:block;
}

/* Chữ */
#textOverlay{
  position:absolute;
  top:50%;
  left:50%;
  width:82%;
  transform:translate(-50%,-50%) scale(.9);

  text-align:center;
  color:#ff3a3a;
  font-family:"Tahoma","Arial",sans-serif;
  font-weight:700;
  letter-spacing:2px;
  line-height:1.2;
  text-transform:uppercase;

  word-wrap:break-word;
  white-space:normal;

  pointer-events:none;
  opacity:0;

  transition:
    opacity .8s ease-out,
    transform .8s cubic-bezier(.2,.9,.3,1.2);
}
</style>
</head>

<body>

<div id="stage">
  <canvas id="c"></canvas>
  <div id="textOverlay"></div>
</div>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
const textBox = document.getElementById("textOverlay");

let W=0,H=0;
const stars = [];
function resize(){
  const rect = stage.getBoundingClientRect();
  canvas.width = rect.width;
  canvas.height = rect.height;
  W = rect.width;
  H = rect.height;
  stars.length = 0;
  for(let i=0;i<200;i++){
    stars.push({
      x: Math.random()*W,
      y: Math.random()*H,
      r: Math.random()*1.5,
      opacity: Math.random()
    });
  }
}
const stage = document.getElementById("stage");

resize();
window.addEventListener("resize", resize);

/* --------------------- FIREWORK SYSTEM --------------------- */

const particles=[];
function rand(a,b){return Math.random()*(b-a)+a;}

function spawnFirework(x,y,color){
  const count = 150;
  for(let i=0;i<count;i++){
    const angle = Math.random()*2*Math.PI;
    const speed = Math.random()*4+1;
    particles.push({
      x,y,
      vx: Math.cos(angle)*speed,
      vy: Math.sin(angle)*speed,
      life: rand(50,90),
      c: color
    });
  }
}

function burstAroundText(){
  const cx=W/2;
  const cy=H/2 - 40;
  for(let i=0;i<6;i++){
    setTimeout(()=>spawnFirework(
      cx+rand(-120,120),
      cy+rand(-80,80),
      ["#ffcc33","#ff5555","#ffaa00","#ffffff"][Math.floor(rand(0,4))]
    ), i*200);
  }
}

function randomSkyFirework(){
  spawnFirework(
    rand(W*0.2,W*0.8),
    rand(H*0.15,H*0.45),
    ["#ffcc33","#ff5555","#ffaa00","#ffffff"][Math.floor(rand(0,4))]
  );
}
function drawStars(){
  for(let s of stars){
    s.opacity += (Math.random()-0.5)*0.02; // nhấp nháy
    if(s.opacity<0) s.opacity=0;
    if(s.opacity>1) s.opacity=1;
    ctx.fillStyle = `rgba(255,255,255,${s.opacity})`;
    ctx.beginPath();
    ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fill();
  }
}

function draw(){
  ctx.fillStyle="rgba(0,0,0,0.28)";
  ctx.fillRect(0,0,W,H);
drawStars();
  for(let i=particles.length-1;i>=0;i--){
    const p = particles[i];
    p.x+=p.vx;
    p.y+=p.vy;
    p.vy+=0.03;
    p.life--;

    ctx.fillStyle=p.c;
    ctx.fillRect(p.x,p.y,2,2);

    if(p.life<=0) particles.splice(i,1);
  }

  requestAnimationFrame(draw);
}
draw();

/* ---------------- TEXT SEQUENCE ---------------- */

const messages = [
  "CHÀO ĐÓN NHỮNG KHỞI ĐẦU MỚI",
  "BÌNH AN",
  "HẠNH PHÚC",
  "HAPPY NEW YEAR 2026"
];

let index = 0;

function showMessage(text){
  textBox.innerText = text;
  textBox.style.opacity = 0;
  textBox.style.transform="translate(-50%,-50%) scale(.8)";
  setTimeout(()=>{
    textBox.style.opacity = 1;
    textBox.style.transform="translate(-50%,-50%) scale(1)";
  },60);

  burstAroundText();
}

function cycleMessages(){
  if(index>=messages.length) return;

  showMessage(messages[index]);

  setTimeout(()=>{
    textBox.style.opacity=0;
    index++;
    setTimeout(cycleMessages,600);
  }, 3000); // thời gian đọc chữ 3s
}

/* Giai đoạn đầu: pháo hoa ngẫu nhiên */
let delay = 500;
let introCount = 0;
let intro = setInterval(()=>{
    randomSkyFirework();
    introCount++;
    if(introCount%3==0) delay = Math.max(150, delay-20); // dồn dần
}, delay);


/* Sau 6s -> chuyển sang chữ */
setTimeout(()=>{
  clearInterval(intro);
  cycleMessages();
}, 6000);

</script>
</body>
</html>
